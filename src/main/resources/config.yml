# CitySim plugin configuration
# You can tweak update intervals and happiness weights later.
updates:
  stats_interval_ticks: 100     # ~5 seconds between stat updates (min 20, max 12000)
  stats_initial_delay_ticks: 40 # Delay before the first stat update (0 - 6000)
  bossbar_interval_ticks: 40    # ~2 seconds
  max_cities_per_tick: 1        # How many city scans to start/process each tick
  max_entity_chunks_per_tick: 2 # Loaded chunks checked per active city scan each tick
  max_bed_blocks_per_tick: 2048 # Block lookups for bed counting per tick
  # Lighting samples for non-high-rise cities focus on parcels with beds; high-rises
  # continue to scan their full claimed volume because interior light drives happiness.

visualization:
  enabled: true
  particle: DUST
  dust_color: "#FF7A00"
  view_distance: 48
  base_step: 0.75
  far_distance_step_multiplier: 1.5
  max_points_per_tick: 800
  refresh_ticks: 3
  async_prepare: true
  jitter: 0.15
  slice_thickness: 0.0
  face_offset: 0.03125
  corner_boost: 2.0
  debug: false

stations:
  counting_mode: traincarts # traincarts (default), manual, or disabled

happiness:
  nature_block_allowlist: []

happiness_weights:
  base_score: 50
  light_neutral_level: 2.0
  nature_max_points: 10
  pollution_max_penalty: 15
  housing_max_points: 10
  light_max_points: 10
  employment_max_points: 15
  overcrowding_max_penalty: 10
  transit_max_points: 5
  employment_neutral: 0.75
  pollution_target_ratio: 0.02
  nature_target_ratio: 0.10

titles:
  enabled: true
  cooldown_ticks: 80
  # MiniMessage formatted text. Use {city} as a placeholder for the city name.
  messages:
    bright:
      - "Gleaming avenues end to end"
      - "Lantern-lit skyline"
      - "Thoroughfares washed in light"
    dark:
      - "Districts drowned in gloom"
      - "Neighborhoods swallowed by shadow"
      - "Whispered alleys stitched with dusk"
    employment_good:
      - "Workshops humming with purpose"
      - "Payrolls steady and sure"
      - "Employment buoying every block"
    employment_bad:
      - "Unemployment gripping the streets"
      - "Idle hands lingering on corners"
      - "Jobless unrest simmering downtown"
    crowding_good:
      - "Generous breathing room"
      - "Spacious dwellings throughout"
      - "Neighborhoods open and cozy"
    crowding_bad:
      - "Walls pressed shoulder to shoulder"
      - "Cramped quarters on every floor"
      - "Districts stacked with residents"
    nature_good:
      - "Green parks woven through blocks"
      - "Boulevards blooming with life"
      - "Living nature threading every avenue"
    nature_bad:
      - "Monotony paved edge to edge"
      - "Tree-starved boulevards"
      - "Lifeless avenues stretching on"
    pollution_good:
      - "Crystal skies overhead"
      - "Fresh winds on every corner"
      - "Clear horizons in every direction"
    pollution_bad:
      - "Smog choking the skyline"
      - "Smogbound dawns each morning"
      - "Air hanging heavy over rooftops"
    housing_good:
      - "Beds enough for everyone"
      - "Restful nights behind every door"
      - "Comfortable quarters throughout"
    housing_bad:
      - "Homelessness spreading unchecked"
      - "Sleepers curled on bare floors"
      - "Shelter failing its own"
    transit_good:
      - "Stations dotting every avenue"
      - "Stops woven through each district"
      - "Lines branching to every borough"
    transit_bad:
      - "Barely a handful of stations"
      - "Routes skipping whole neighborhoods"
      - "Districts stranded without stops"
    default_good:
      - "Contented citizens everywhere"
      - "Life unfolding in peace"
      - "Morale holding steady"
    default_bad:
      - "Uneasy citizens on edge"
      - "Discontent whispering through blocks"
      - "Morale sliding downhill"
    ghost_town:
      - "<gray>A fresh city awaiting its first residents</gray>"
      - "<gray>New streets patiently awaiting their bustle</gray>"
      - "<gray>Districts standing ready for settlers to arrive</gray>"

levels:
  enabled: true
  thresholds: [0, 20, 35, 50, 65, 80, 90]
  min_scans_above_gate: 3
  cooldown_scans: 10
  decay_when_below: 0.05

links:
  enabled: true
  link_distance_blocks: 400

migration:
  enabled: true
  interval_ticks: 200
  max_moves_per_tick: 1
  cooldown_minutes: 10
  min_city_population_floor: 10

  logic:
    freshness_base_secs: 240 # Base allowance before staleness kicks in; dynamic queue estimates extend this automatically
    freshness_queue_slack_secs: 60 # Extra buffer layered on top of the dynamic queue estimate
    freshness_backlog_weight: 1.0 # Scales how strongly pending/active scan backlog extends freshness
    require_consistency_scans: 3
    min_prosperity_delta: 5
    dest_min_housing_ratio: 1.05
    dest_min_employment_floor: 0.75
    post_move_housing_floor: 1.00
    allow_zero_population_destinations: true
    zero_population_prosperity_boost: 5.0
    zero_population_employment_grace: 3
    zero_population_min_beds: 1
    score_weights:
      link_strength: 0.6
      prosperity_delta: 0.3
    unemployment:
      none_share_soft_cap: 0.10
      none_share_hard_cap: 0.20
      nitwit_relief_ratio: 1.0

  rate:
    interval_ticks: 200
    global_per_interval: 10
    per_origin_per_interval: 2
    per_destination_per_interval: 2
    per_link_per_interval: 1
    jitter_ticks_max: 40

  teleport:
    radius: 8
    max_samples: 24
    require_y_at_least_rail: true
    disallow_on_rail: true
    disallow_below_rail: true
    rail_avoid_horiz_radius: 1
    rail_avoid_vert_above: 3
    platform_offsets:
      - [ 0, +1,  0]
      - [ 1, +1,  0]
      - [-1, +1,  0]
      - [ 0, +1,  1]
      - [ 0, +1, -1]
      - [ 1, +1,  1]
      - [ 1, +1, -1]
      - [-1, +1,  1]
      - [-1, +1, -1]
    require_wall_sign: true # Leave true for wall-mounted TrainCarts signs; set to false if your stations use standing/post signs
    max_candidates_per_station: 8
    cache_ttl_ticks: 200
    rebuild_per_tick: 8
    platform_vertical_search: 6
    platform_horizontal_offset: 0.4
    floor_allowlist: []
    floor_block_blacklist:
      - tag:CARPETS
      - tag:TRAPDOORS
      - tag:FENCES
      - NETHER_BRICK_FENCE
      - COBBLESTONE_WALL
      - MOSSY_COBBLESTONE_WALL
      - GLASS_PANE
      - IRON_BARS
      - WATER
      - LAVA
      # Use explicit variants if tags are unavailable in your loader
      - SCAFFOLDING
      - ICE
      - PACKED_ICE
      - BLUE_ICE
      - SLIME_BLOCK
      - HONEY_BLOCK
      - MAGMA_BLOCK
      - CACTUS
      - SWEET_BERRY_BUSH
    rail_materials:
      - RAIL
      - POWERED_RAIL
      - DETECTOR_RAIL
      - ACTIVATOR_RAIL

ui:
  bossbar:
    show_level_progress: true
    show_on_cooldown: true
